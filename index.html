<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>CM5-LTS Serial Tool</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 30px auto; line-height: 1.5; }
    textarea { font-family: monospace; width: 100%; box-sizing: border-box; }
    label { font-weight: bold; display: block; margin-bottom: 4px; }
    .controls { margin: 15px 0; }
    .rx-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    #port_info {
      font-weight: bold;
      transition: color 0.3s ease;
    }
    #port_info.disconnected { color: #d32f2f; }
    #port_info.connected { color: #2e7d32; }
    progress { width: 100%; height: 20px; }
    #fw_file_name { margin-left: 10px; color: #555; font-style: italic; }
    #version_info { font-size: 0.9em; color: #666; margin-bottom: 10px; }
    #elapsed_time { font-size: 0.9em; color: #444; margin-top: 4px; }
  </style>
</head>
<body>
  <!-- Version stamp: index.html V17 -->
  <div id="version_info">
    Files loaded: 
    <span id="html_ver">HTML (loading...)</span> | 
    <span id="core_ver">test_script.js (loading...)</span> | 
    <span id="fw_ver">fw_update.js (loading...)</span>
  </div>

  <h2>CM5-LTS Serial Tool</h2>

  <label for="term_input">Send Bytes</label>
  <textarea id="term_input" rows="4" placeholder="Enter hex bytes (e.g. c3050001b6)"></textarea>

  <div style="margin: 12px 0;">
    <button id="csum">CSUM</button>
    <input id="csum_result" readonly size="3" value="00">
  </div>

  <div class="controls">
    <button id="openclose_port">Open</button>
    <button id="send" disabled>Send</button>
    <button id="clear">Clear</button>
  </div>

  <!-- FW update controls -->
  <div class="controls">
    <button id="fw_browse">Open FW File</button>
    <span id="fw_file_name">No file selected</span>
    <button id="fw_update" disabled>Update FW</button>
    <input type="file" id="fw_file_input" accept=".tthex,.hex" style="display:none;">
  </div>

  <label for="debug_window">Debug</label>
  <textarea id="debug_window" readonly rows="10">Debug messages</textarea>

  <div class="rx-header">
    <strong>Received Bytes</strong>
    <span id="rx_count" style="color: #555;">0 bytes received</span>
  </div>

  <div style="margin-bottom: 8px;">
    <label for="display_mode" style="display: inline;">Display Data As:</label>
    <select id="display_mode">
      <option value="hex" selected>HEX</option>
      <option value="ascii">ASCII</option>
    </select>
  </div>

  <textarea id="term_window" readonly rows="14"></textarea>

  <!-- FW progress + elapsed timer -->
  <div id="fw_progress_container" style="margin-top: 15px; display:none;">
    <label for="fw_progress">Firmware Upload Progress:</label>
    <progress id="fw_progress" value="0" max="100" style="width:100%; height:20px;"></progress>
    <div id="fw_status" style="margin-top: 6px; color: #555;">FW Status: Ready</div>
    <div id="elapsed_time" style="margin-top: 6px; font-size: 0.9em; color: #444;">Elapsed: 00:00</div>
  </div>

  <span id="port_info" class="disconnected">Disconnected</span>

  <script src="test_script.js"></script>
  <script src="fw_update.js"></script>
</body>
</html>
